---
import Container from '../components/Container.astro';
import Button from '../components/Button.astro';
import Layout from '../layouts/Layout.astro';
import Table from '../components/Table.astro';
import Upcoming from '../components/Upcoming.astro';
import background from '../assets/img/background.jpg'
import image1 from '../assets/img/image-1.jpg'
import image2 from '../assets/img/image-2.jpg'
import type { Event } from '../../types/event.interface';

const response = await fetch('https://gospeak.io/api/groups/humantalks-paris/events?page-size=15');
const data: { data: Event[] } = await response.json();
const events: Event[] = data.data

const upcomingEvents = events.filter(event => {
  return new Date(event.start) >= new Date()
}).sort((a, b) => Number(new Date(a.start)) - Number(new Date(b.start))).slice(0, 3)

const pastEvents = events.filter(event => {
  return new Date(event.start) < new Date()
}).slice(0, 3)
---

<Layout title="Welcome to Astro.">
  <div class="bg-fixed bg-no-repeat absolute top-0 left-0 right-0 bottom-0 opacity-50" style={{ backgroundImage: `url(${background.src})`, backgroundSize: '50%', backgroundPosition: '100% 0%' }} />

  <div class="relative py-12 md:py-32">
    <Container class="relative md:flex items-center md:space-x-12 px-12">
      <div class="grow">
        <h1 class="font-display text-4xl sm:text-5xl font-semibold  text-[#790357]">
          HumanTalks Paris
        </h1>
        <div class="font-mono space-y-6 mt-4 text-lg max-w-xl text-slate-950 tracking-tight leading-relaxed">
          <p>
            Des Talks pour tous les développeurs et développeuses. Tous les 2èmes mardis du mois.
          </p>
        </div>

        <dl class="mt-6 sm:pt-6 sm:border-t sm:border-dotted border-[#790357] sm:flex sm:items-center sm:justify-between">
          {[
            ['CFP ouverts à tout.e.s', '314 Speakers'],
            [`+100 filmés`, '350 Talks'],
            [`+15k abonnés Youtube`, '7300 Membres'],
            [`Depuis + de 6 ans !`, '81 Meetups'],
          ].map(([name, value]) => (
            <div class="border-b border-dotted border-[#790357] py-3 sm:py-0 sm:border-none">
              <dd class="text-lg sm:text-lg font-semibold tracking-tight">
                {value}
              </dd>
              <dt class="font-mono text-sm tracking-tight text-slate-950">{name}</dt>
            </div>
          ))}
        </dl>
      </div>

      <div class="flex -space-x-6 justify-center shrink-0 mt-12 md:mt-0">
        <div class="w-36 sm:w-56 aspect-[9/12] shrink-0 bg-slate-500 rounded-3xl -translate-y-3 sm:translate-y-0 sm:-mt-12 overflow-hidden relative">
          <img src={image1.src} class="absolute w-full h-full object-cover" />
        </div>
        <div class="w-36 sm:w-56 aspect-[9/12] shrink-0 bg-slate-500 rounded-3xl translate-y-3 sm:translate-y-0 sm:-mb-12 overflow-hidden relative">
          <img src={image2.src} class="absolute w-full h-full object-cover" />
        </div>
      </div>
    </Container>

    <Upcoming events={upcomingEvents} />

    <Table events={pastEvents} />

    <Container class="flex justify-center">
      <iframe width="560" height="315" src="https://www.youtube.com/embed/C0F_kDRxAcI?si=wgTxZuKSPSWlhhU0&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
    </Container>
  </div>
</Layout>